diff --git a/mod/chat/gui_sockets/index.php b/mod/chat/gui_sockets/index.php
index 228454d..ab3d83b 100644
--- a/mod/chat/gui_sockets/index.php
+++ b/mod/chat/gui_sockets/index.php
@@ -27,7 +27,9 @@ if (!$cm = get_coursemodule_from_instance('chat', $chat->id, $course->id)) {
 require_login($course, false, $cm);
 $context = get_context_instance(CONTEXT_MODULE, $cm->id);
 
-require_capability('mod/chat:chat', $context);
+if (isguestuser()) {
+    print_error('noguests', 'chat');
+}
 
 /// Check to see if groups are being used here
  if ($groupmode = groups_get_activity_groupmode($cm)) {   // Groups are being used
